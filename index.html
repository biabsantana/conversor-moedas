<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="assets/css/style.css">
    <title>Conversor de Moedas</title>
</head>
<body>
    <main>
        <div class="header">
        <h1>Conversor de Moedas</h1>
        </div>
        <div class="content">
            <select class="selectorIn">
             <!-- options -->
            </select>
            <input type="number" class="money" required>
            <select class="selectorOut">
             <!-- options -->
            </select>
            <button onclick="getInput('.money')">Submit</button>
        </div>
        <p></p>
    </main>    
</body>
<script>
    var oReq = new XMLHttpRequest();
    oReq.onload = loadData;
    oReq.open("GET", "https://data.fixer.io/api/latest?access_key=18f0676055fe28e974b77864d20fc736");
    oReq.send();
    oReq.responseType = "json";
    var data;

    function loadData (){
            data = this.response;
            var coins = Object.keys(data.rates);    
            newOption(coins, "selectorIn");
            newOption(coins, "selectorOut");
    }

    function newOption(coins, seletor){
        for (var i=0; i< coins.length; i++){
               var object = document.createElement("option");
               object.value = coins[i];
               object.textContent = coins[i];
               document.querySelector("."+seletor).appendChild(object);
            }
    }

    function getInput(inputClass){
        var money = document.querySelector(""+inputClass);
        var currency = document.getElementsByTagName('select');
        if (money.value == ""){
            return alert('Digite um valor.');
        }
        var result = converter(currency, money);
        var text = document.querySelector("p");
        text.textContent = "Valor convertido = "+result.toFixed(5) + " " + currency[1].value;
    }
    
    function converter(currency, money){
        rates = data.rates;
        return money.value * (rates[currency[1].value] / rates[currency[0].value]);
    }

</script>
</html>